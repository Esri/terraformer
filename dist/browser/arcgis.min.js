(function(e,t){typeof module=="object"&&typeof module.exports=="object"&&(exports=module.exports=t()),typeof define=="function"&&define.amd&&define(["terraformer/terraformer"],t),typeof e.navigator=="object"&&(typeof e.Terraformer=="undefined"&&(e.Terraformer={}),e.Terraformer.ArcGIS=t())})(this,function(){function n(e){var t=[],n;for(var r=0;r<e.length;r++){n=e[r];if(n.length>1)for(var i=0;i<n.length;i++)t.push(n[i]);else t.push(n[0])}return t}function r(e){if(e.x&&e.y)return"Point";if(e.points)return"MultiPoint";if(e.paths)return e.paths.length===1?"LineString":"MultiLineString";if(e.rings)return e.rings.length===1?"Polygon":"MultiPolygon";if(e.attributes&&e.geometry)return"Feature";throw"Terraformer: invalid ArcGIS input. Are you sure your data is properly formatted?"}function i(e){var n=r(e),s=e.geometry?e.geometry.spatialReference:e.spatialReference,o={type:n};n==="Feature"&&(o.properties=e.attributes);switch(n){case"Point":o.coordinates=[e.x,e.y];break;case"MultiPoint":o.coordinates=e.points;break;case"LineString":o.coordinates=e.paths[0];break;case"MultiLineString":o.coordinates=e.paths;break;case"Polygon":o.coordinates=e.rings;break;case"MultiPolygon":o.coordinates=[e.rings];break;case"Feature":o.geometry=i(e.geometry)}return s.wkid===102100&&(o=t.toGeographic(o)),new t.Primitive(o)}function s(e,t){var r=t?t:{wkid:4326},i={};switch(e.type){case"Point":i.x=e.coordinates[0],i.y=e.coordinates[1],i.spatialReference=r;break;case"MultiPoint":i.points=e.coordinates,i.spatialReference=r;break;case"LineString":i.paths=[e.coordinates],i.spatialReference=r;break;case"MultiLineString":i.paths=e.coordinates,i.spatialReference=r;break;case"Polygon":i.rings=e.coordinates,i.spatialReference=r;break;case"MultiPolygon":i.rings=n(e.coordinates),i.spatialReference=r;break;case"Feature":i.geometry=s(e.geometry),i.attributes=e.properties}return i}var e={},t;return typeof this.navigator=="object"&&(t=this.Terraformer),typeof module=="object"&&typeof module.exports=="object"&&(t=require("terraformer")),arguments[0]&&typeof define=="function"&&define.amd&&(t=arguments[0]),e.parse=i,e.convert=s,e});